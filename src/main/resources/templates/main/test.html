<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<h1>모든 게시물</h1>
<div class="note-container" id="note-container"></div>
<div class="pagination" id="pagination"></div>

<script>
    const noteColors = [
        "#FBD5D5", "#F6FDFF", "#FFFFF5", "#FBF9FF", "#F3FFFD", "#FFF7FC", "#F7FFF3", "#FFF8F2",
    ];
    const tapeColors = [
        "#FBD5D5", "#D5F4FB", "#FBFAD5", "#EDD5FB", "#D5FBF4", "#FBD5EE", "#E1FBD5", "#FFC692",
    ];

    const noteContainer = document.getElementById("note-container");
    const pagination = document.getElementById("pagination");

    let notesData = [];
    const notesPerPage = 24;

    fetch("/main/allMission")
        .then(res => res.json())
        .then(data => {
            console.log("Fetched data:", data); // 데이터 로그
            notesData = data;
            renderNotes(1);
            renderPagination();
        })
        .catch(error => console.error("Error fetching data:", error));

    function renderNotes(page) {
        noteContainer.innerHTML = "";
        const start = (page - 1) * notesPerPage;
        const end = start + notesPerPage;
        const notesToDisplay = notesData.slice(start, end);

        notesToDisplay.forEach(note => {
            console.log("Rendering note:", note); // 노트 로그

            // 날짜 변환
            const date = new Date(note.date);
            const formattedDate = `FROM.${date.getFullYear().toString().slice(2)}${(date.getMonth() + 1).toString().padStart(2, '0')}${date.getDate().toString().padStart(2, '0')}`; // 수정함

            const noteElement = document.createElement("div");
            noteElement.className = "note";
            noteElement.innerHTML = `
                <div class="masking-tape"></div>
                <span>${formattedDate}</span> <!-- 수정함 -->
                <span>${note.title}</span>
            `;
            const randomIndex = Math.floor(Math.random() * noteColors.length);
            const selectedNoteColor = noteColors[randomIndex];
            const selectedTapeColor = tapeColors[randomIndex];

            noteElement.style.backgroundColor = selectedNoteColor;
            noteElement.querySelector(".masking-tape").style.backgroundColor = selectedTapeColor;
            noteContainer.appendChild(noteElement);
        });
    }

    function renderPagination() {
        pagination.innerHTML = "";
        const pageCount = Math.ceil(notesData.length / notesPerPage);

        for (let i = 1; i <= pageCount; i++) {
            const pageBtn = document.createElement("div");
            pageBtn.className = "page-btn";
            pageBtn.textContent = i;
            if (i === 1) pageBtn.classList.add("active");
            pageBtn.addEventListener("click", function () {
                document.querySelectorAll(".page-btn").forEach((btn) => {
                    btn.classList.remove("active");
                });
                pageBtn.classList.add("active");
                renderNotes(i);
            });
            pagination.appendChild(pageBtn);
        }
    }
</script>
</body>
</html>
